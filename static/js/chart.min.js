function populateChart(){var e,t,n,s=document.getElementById("chart"),i=document.getElementById("lat").value,r=document.getElementById("long").value,a=document.getElementById("date").value,l=document.getElementById("error"),o=document.getElementById("fetch");if(l.setAttribute("style",""),""==i||""==r)return l.innerHTML="Please fill in the latitude and longitude.",void l.setAttribute("style","display:inline-block");if(a&&!a.match(/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/))return l.innerHTML="This date is formatted incorrectly. (Must be in the format yyyy-mm-dd.)",void l.setAttribute("style","display:inline-block");s.setAttribute("style","visibility:hidden"),o.setAttribute("style","display:inline-block"),n=""==a?(e="/api/"+i+"/"+r,!0):(e="/api/date/"+i+"/"+r+"/"+a,!1),axios.get(e).then(function(e){return"No timezone"==(t=e.data).error?(l.innerHTML="Sorry, we can't find a timezone for those coordinates.<br>(And we can't render times without timezones.)",l.setAttribute("style","display:inline-block"),void o.setAttribute("style","")):"Invalid coordinates"==t.error?(l.innerHTML="Not a valid latitude and longitude.",l.setAttribute("style","display:inline-block"),void o.setAttribute("style","")):(renderChart(t,n),o.removeAttribute("style"),void s.removeAttribute("style"))})}function renderChart(e,t){var n=[],s=!0;for(i in e)"False"==e[i].isNegative?(s=!1,n.push(e[i])):n.push({x:i,value:"missing"});1==s&&(n=[{x:0,y:0,z:-10}]),n.date=e.date,n.lat=e.lat,n.long=e.long,n.sunrise=e.sunrise,n.sunset=e.sunset,n.day_length=e.day_length,"0 hours, 0 minutes"!=n.day_length||s||(n.day_length="24 hours, 0 minutes"),"0 hours, 0 minutes"!=n.day_length&&"24 hours, 0 minutes"!=n.day_length||(n.sunrise="N/A",n.sunset="N/A");var i,r=[],a=[],l=[],o=[],d=t?"<span style='font-size:20px'>"+e.date+"</span><br>":"",t=d+"<span style='font-size:16px'>Sunrise: "+n.sunrise+"</span>, <span style='font-size:16px'>Sunset: "+n.sunset+"</span><br><span style='font-size:16px'>Length of Day: "+n.day_length+"</span><br><span style='font-size:10px'>Sunrise, sunset, and day length from https://sunrise-sunset.org/api<span>";for(i in n)r.push(n[i].x),a.push(n[i].y),l.push(n[i].z),o.push(n[i].timestring);d=[{y:a,x:r,z:l,text:o,hovertemplate:"%{text}",mode:"markers",name:"",line:{color:"peru"},type:"scatter3d",marker:{color:"#fcc203"}}],t={title:t,font:{family:"Arial",size:16},scene:{aspectmode:"cube",xaxis:{showgrid:!1,tickvals:[-99,99],ticktext:["N","S"],range:[-100,100],title:""},yaxis:{tickvals:[-99,99],ticktext:["W","E"],showgrid:!1,title:"",scaleanchor:"x",range:[-100,100]},zaxis:{showticklabels:!1,showgrid:!1,visible:!1,linewidth:0,title:"",range:[0,100]}}};Plotly.newPlot("chart",d,t)}
